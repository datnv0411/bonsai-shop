<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<!-- Basic -->

<head th:replace="fragment :: head">

<body>
    <div th:replace="fragment :: top"></div>
    <!-- Start All Title Box -->
    <div class="all-title-box">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <h2>Chi tiết sản phẩm</h2>
                    <ul class="breadcrumb">
                        <li class="breadcrumb-item"><a href="list-product">Cửa hàng</a></li>
                        <li class="breadcrumb-item active">CHI TIẾT SẢN PHẨM </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End All Title Box -->

    <!-- Start Shop Detail  -->
    <div class="shop-detail-box-main">
        <div class="container">
            <div class="row">
                <div class="col-xl-5 col-lg-5 col-md-6">
                    <div id="carousel-example-1" class="single-product-slider carousel slide" data-ride="carousel">
                        <div class="carousel-inner" role="listbox">
                            <div class="carousel-item active"><img class="d-block w-100" th:src="@{'images/product/' + ${foundProduct.productImages[0].path}}" alt="First slide"></div>
                            <div class="carousel-item"> <img class="d-block w-100" th:src="@{'images/product/' + ${foundProduct.productImages[1].path}}" alt="Second slide"> </div>
                            <div class="carousel-item"> <img class="d-block w-100" th:src="@{'images/product/' + ${foundProduct.productImages[2].path}}" alt="Third slide"> </div>
                            <div class="carousel-item"> <img class="d-block w-100" th:src="@{'images/product/' + ${foundProduct.productImages[3].path}}" alt="Fourth slide"> </div>
                        </div>
                        <a class="carousel-control-prev" href="#carousel-example-1" role="button" data-slide="prev"> 
						<i class="fa fa-angle-left" aria-hidden="true"></i>
						<span class="sr-only">Previous</span> 
					</a>
                        <a class="carousel-control-next" href="#carousel-example-1" role="button" data-slide="next"> 
						<i class="fa fa-angle-right" aria-hidden="true"></i> 
						<span class="sr-only">Next</span> 
					</a>
                        <ol class="carousel-indicators">
                            <li data-target="#carousel-example-1" data-slide-to="0" class="active">
                                <img class="d-block w-100 img-fluid" th:src="@{'images/product/' + ${foundProduct.productImages[0].path}}" alt="Ảnh sản phẩm" />
                            </li>
                            <li data-target="#carousel-example-1" data-slide-to="1">
                                <img class="d-block w-100 img-fluid" th:src="@{'images/product/' + ${foundProduct.productImages[1].path}}" alt="Ảnh sản phẩm" />
                            </li>
                            <li data-target="#carousel-example-1" data-slide-to="2">
                                <img class="d-block w-100 img-fluid" th:src="@{'images/product/' + ${foundProduct.productImages[2].path}}" alt="Ảnh sản phẩm" />
                            </li>
                            <li data-target="#carousel-example-1" data-slide-to="2">
                                <img class="d-block w-100 img-fluid" th:src="@{'images/product/' + ${foundProduct.productImages[3].path}}" alt="Ảnh sản phẩm" />
                            </li>
                        </ol>
                    </div>
                </div>
                <div class="col-xl-7 col-lg-7 col-md-6">
                    <div class="single-product-details">
                        <h2 th:text="${foundProduct.nameProduct}">Name Product</h2>
                        <h5 th:if="${foundProduct.price == foundProduct.priceSale}"><span th:text="${foundProduct.price}"></span><span> VND</span></h5>
                        <h5 th:unless="${foundProduct.price == foundProduct.priceSale}"> <del><span th:text="${foundProduct.price}"></span><span> VND</span></del>
                            <h5><span th:text="${foundProduct.priceSale}"></span><span> VND</span></h5></h5>
                        <p class="available-stock" th:if="${foundProduct.quantity > 0}"><span>Có sẵn </span><span th:text="${foundProduct.quantity}">Quantity</span><span> sản phẩm </span></p>
                        <p class="available-stock" th:unless="${foundProduct.quantity > 0}"><span>Hết hàng</span></p>
						<h4>Mô tả sản phẩm:</h4>
						<p th:text="${foundProduct.description}">Description</p>
						<ul>
							<li>
								<div class="form-group quantity-box">
                                    <h4>Số lượng:</h4>
                                    <div th:replace="quantity_control :: quantity_control(1, ${foundProduct.id}, ${foundProduct.quantity})" th:remove="tag"></div>
								</div>
							</li>
						</ul>
                        <p id="msgAddToCart"></p>
						<div class="price-box-bar">
							<div class="cart-and-bay-btn" th:if="${foundProduct.quantity > 0}">
                                <button id="addOneToCart" class="btn hvr-hover" data-fancybox-close=""
                                        style="padding: 10px 20px; font-weight: 700; color: #ffffff; border: none;">Mua hàng</button>
								<button id="addToCart" class="btn hvr-hover" data-fancybox-close=""
                                style="padding: 10px 20px; font-weight: 700; color: #ffffff; border: none;">Thêm vào giỏ hàng</button>
							</div>
                            <div class="cart-and-bay-btn" th:unless="${foundProduct.quantity > 0}">
                                <button disabled id="outOfStock" class="btn hvr-hover" data-fancybox-close=""
                                        style="padding: 10px 20px; font-weight: 700; color: #ffffff; border: none;">Hết hàng</button>
                            </div>
						</div>

<!--						<div class="add-to-btn">-->
<!--							<div class="share-bar">-->
<!--								<a class="btn hvr-hover" href="#"><i class="fab fa-facebook" aria-hidden="true"></i></a>-->
<!--								<a class="btn hvr-hover" href="#"><i class="fab fa-google-plus" aria-hidden="true"></i></a>-->
<!--								<a class="btn hvr-hover" href="#"><i class="fab fa-twitter" aria-hidden="true"></i></a>-->
<!--								<a class="btn hvr-hover" href="#"><i class="fab fa-pinterest-p" aria-hidden="true"></i></a>-->
<!--								<a class="btn hvr-hover" href="#"><i class="fab fa-whatsapp" aria-hidden="true"></i></a>-->
<!--							</div>-->
<!--						</div>-->
                    </div>
                </div>
            </div>

            <div class="row my-5">
                <div class="card card-outline-secondary my-4">
                    <div class="card-header">
                        <h2>Bình luận</h2>
                    </div>
                    <div class="card-body">
                        <div class="media mb-3" th:each="c : ${comments}">
                            <div class="mr-2">
                                <img class="rounded-circle border p-1"
                                     width="64px" height="64px"
                                     th:src="${c.user.avatar == 'avatar-default.png'} ? @{'images/user/0/avatar-default.png'} : @{'images/user/' + ${c.user.id} + '/' + ${c.user.avatar}}"
                                     alt="Generic placeholder image">
                            </div>
                            <div class="media-body">
                                <p th:text="${c.content}">content</p>
                                <small class="text-muted">Đăng bởi <span th:text="${c.createdBy}">username</span> vào <span th:text="${c.createdDate}">time</span></small>
                            </div>
                            <a class="margin-left:20px; color:black;" sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{'/product/remove-comment?id=' + ${c.id}}">X</a>
                            <hr>
                        </div>
                        <div th:if="${#lists.isEmpty(comments)}">
                            <h3>Không tìm thấy kết quả nào.</h3>
                        </div>
                        <form sec:authorize="isAuthenticated()" th:if="${isBought == true}" th:action="@{'/product/comment?productId=' + ${foundProduct.id}}" method="post" th:object="${newComment}">
                            <div class="media mb-3">
                                <div class="mr-2">
                                    <img sec:authorize="isAuthenticated()" class="rounded-circle border p-1"
                                         width="64px" height="64px"
                                         th:src="${logUser.avatar == 'avatar-default.png'} ? @{'images/user/0/avatar-default.png'} : @{'images/user/' + ${logUser.id} + '/' + ${logUser.avatar}}"
                                         alt="Generic placeholder image">
                                </div>
                                <div class="media-body">
                                    <input class="form-control" th:field="*{content}" type="text" placeholder="Viết bình luận">
                                </div>
                                &nbsp;
                                <button class="btn hvr-hover" style="height: 37px; padding: 10px 20px; font-weight: 700; color: #ffffff; border: none;" type="submit">Đăng</button>
                            </div>
                        </form>
<!--                        <a th:href="@{'/product/comment?productId=' + ${foundProduct.id}}" class="btn hvr-hover" sec:authorize="isAuthenticated()">Viết bình luận</a>-->
                    </div>
                </div>
            </div>

            <div class="row my-5">
                <div class="col-lg-12">
                    <div class="title-all text-center">
                        <h1>Các sản phẩm liên quan</h1>
                        <p id="msgatc"></p>
                    </div>
                    <div class="featured-products-box owl-carousel owl-theme">
                        <div class="item" th:each="product : ${listProduct}">
                            <div class="products-single fix">
                                <div class="box-img-hover">
                                    <img th:src="@{'images/product/' + ${product.productImages[0].path}}" class="img-fluid" alt="Image">
                                    <div class="mask-icon">
                                        <a th:href="@{'product-detail?productId=' + ${product.id}}" class="cart" href="#">Mua ngay</a>
                                    </div>
                                </div>
                                <div class="why-text">
                                    <h3 id="idPr" style="display:none;" th:text="${product.id}"></h3>
                                    <h4 th:text="${product.nameProduct}">Name Product</h4>
                                    <h5><span th:text="${product.priceSale}"></span><span> VND</span></h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <!-- End Cart -->

    <div th:replace="fragment :: instagramFeed" th:remove="tag"></div>
    <footer>
        <div th:replace="fragment :: footer" th:remove="tag"></div>
    </footer>
    <div th:replace="fragment :: copyright" th:remove="tag"></div>
    <a th:replace="fragment :: backToTop" th:remove="tag"></a>
    <div th:replace="fragment :: finalScript" th:remove="tag"></div>
    <script type="text/javascript">
        contextPath = "[[@{/}]]";
        var productId = "[[${foundProduct.id}]]";
    </script>
    <script th:src="@{/js/add-to-cart.js}"></script>
    <script th:src="@{/js/quantity_control.js}"></script>
</body>

</html>